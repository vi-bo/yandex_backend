### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–æ–¥–∞ Python

–ü–µ—Ä–≤–æ–∏—Å—Ç–æ—á–Ω–∏–∫: [Python - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–æ–¥–∞ - YouTube](https://www.youtube.com/watch?v=Qw-Wj6NZelQ)

–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ python, –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ black

`black -S -l 79 .`

```bash
reformatted main.py
reformatted bot/messages.py
reformatted main0.py
reformatted bot/handlers.py

All done! ‚ú® üç∞ ‚ú®
4 files reformatted, 1 file left unchanged.
```

#### –ò—Å—Ç–æ—Ä–∏—è –æ –∫–æ–¥–µ ‚Ññ1 (telegram - bot)

–ò—Ç–æ–≥–æ, –Ω–∞–ø–∏—Å–∞–ª–∏ —Ç–µ–ª–µ–≥—Ä–∞–º –±–æ—Ç (python-telegram-bot 20.0a2, –≤ –ø—Ä–æ–µ–∫—Ç–µ dls –ø–æ nst –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª telebot), '—ç—Ö–æ-–±–æ—Ç'. –£–∑–Ω–∞–ª–∏, –∫–∞–∫ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ —Ç–∞–∫–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –≤–∏–¥–µ –∏–µ—Ä–∞—Ä—Ö–∏–∏ –∫–ª–∞—Å—Å–æ–≤. –ù–µ –¥–µ–ª–∞–ª–∏ –ø–æ –≤—Å–µ–º—É –∫–æ–¥—É if, –∞ –Ω–∞–ø–∏—Å–∞–ª–∏ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ –∏ –ø–æ—Ç–æ–º –≤—ã–∑—ã–≤–∞–ª–∏.

–°–¥–µ–ª–∞–ª–∏ —Å–µ–∫—Ä–µ—Ç–Ω–∏—Ü—É, –∑–∞–ø—É—Å–∫–∞–µ–º —Ñ–∞–π–ª —á–µ—Ä–µ–∑ 

`python main.py --token $(cat secrets/token)`



#### –ò—Å—Ç–æ—Ä–∏—è –æ –∫–æ–¥–µ ‚Ññ2 (scooters)

–ê—Å—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ asyncio. –ü—Ä–∏–ª–æ–∂–Ω–∏–µ –±—É–¥–µ—Ç –æ—Ç–¥–∞–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Å–∞–º–æ–∫–∞—Ç–æ–≤ –≤ –¥–≤—É—Ö –≤–∏–¥–∞—Ö:

- –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è;
- –¥–ª—è –∞–¥–º–∏–Ω–∫–∏ (–ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ —Å–∞–º–æ–∫–∞—Ç–æ–≤), –ø—Ä–∏ —ç—Ç–æ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤—ã–¥–∞—é—Ç—Å—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω—ã–µ –≤ —Ç–µ–∫—Å—Ç -> –∞–¥—Ä–µ—Å (–Ω–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã).

–ü–∏—Å–∞—Ç—å –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑—É—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ –û–ü–ü.

–ü–æ—Å–º–æ—Ç—Ä–∏–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞:

`tree`

```bash
.
‚îú‚îÄ‚îÄ app # –º–æ–¥—É–ª—å app (–æ—Å–Ω–æ–≤–æ–π –º–æ–¥—É–ª—å, –≤ –∫–æ—Ç–æ—Ä–æ–º –ø–∏—à–µ–º –≤—Å—é –ª–æ–≥–∏–∫—É)
‚îÇ   ‚îú‚îÄ‚îÄ api # –ø–∞–ø–∫–∞ –¥–ª—è —Ä—É—á–µ–∫ (–∏—Ö —É –Ω–∞—Å –±—É–¥–µ—Ç –¥–≤–µ, —Å–¥–µ–ª–∞–µ–º –Ω–∞ –∫–∞–∂–¥—É—é —Ä—É—á–∫—É —Å–≤–æ–π —Ñ–∞–π–ª)
‚îÇ   ‚îú‚îÄ‚îÄ context.py # —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–ª–∞—Å—Å AppContext
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ routes.py # routes
‚îÇ   ‚îî‚îÄ‚îÄ utils # –ø–∞–ø–∫–∞ utils
‚îÇ       ‚îú‚îÄ‚îÄ geocode.py # —Ñ–∞–π–ª –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îî‚îÄ‚îÄ secrets.py # –º–æ–¥—É–ª—å, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –∫–ª–∞—Å—Å SecretsReader
‚îú‚îÄ‚îÄ main.py # –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª
‚îî‚îÄ‚îÄ scripts
 ‚îú‚îÄ‚îÄ database_fill.sql
 ‚îî‚îÄ‚îÄ database_schema.sql
```

–î–æ–±–∞–≤–ª—è–µ–º –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
.
‚îú‚îÄ‚îÄ app
‚îÇ   ‚îú‚îÄ‚îÄ api
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py # –¥–æ–±–∞–≤–∏–ª–∏, —á—Ç–æ–±—ã python –ø–æ–Ω–∏–º–∞–ª, —á—Ç–æ —ç—Ç–æ –º–æ–¥—É–ª—å
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ v1 # –ø–∞–ø–∫–∞ –≤–µ—Ä—Å–∏–∏ api
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ get_scooters_admin.py        
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ get_scooters.py
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ __init__.py # –¥–æ–±–∞–≤–∏–ª–∏, —á—Ç–æ–±—ã python –ø–æ–Ω–∏–º–∞–ª, —á—Ç–æ —ç—Ç–æ –º–æ–¥—É–ª—å
‚îÇ   ‚îú‚îÄ‚îÄ context.py
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py                    
‚îÇ   ‚îú‚îÄ‚îÄ routes.py
‚îÇ   ‚îî‚îÄ‚îÄ utils # –ø–∞–ø–∫–∞ —Ç—Ä–µ—Ç—å–µ–≥–æ —Å–ª–æ—è
‚îÇ       ‚îú‚îÄ‚îÄ geocode.py
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îî‚îÄ‚îÄ secrets.py
‚îú‚îÄ‚îÄ main.py
‚îî‚îÄ‚îÄ scripts
    ‚îú‚îÄ‚îÄ database_fill.sql
    ‚îî‚îÄ‚îÄ database_schema.sql
```

–ó–∞–ø—É—Å–∫–∞–µ–º –∏–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ (—Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏–ª—Å—è –Ω–∞ –ø–æ—Ä—Ç—É 8080)
`python main.py --secrets-dir secret`

```bash
======== Running on http://0.0.0.0:8080 ========
 (Press CTRL+C to quit)
```

–ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–±–æ—Ç—É —á–µ—Ä–µ–∑ curl, –≤–ø–∏—Å—ã–≤–∞–µ–º –ø–æ—Ä—Ç –∏ –∞–¥—Ä–µ—Å —Ä—É—á–∫–∏
`curl http://localhost:8080/v1/scooters`

```bash
{"hello": "test"}
```

–ò—Ç–æ–≥–æ —Å–¥–µ–ª–∞–ª–∏ –∫–∞–∫–æ–µ-—Ç–æ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–∞–º —á—Ç–æ-—Ç–æ –æ—Ç–≤–µ—á–∞–µ—Ç.

–°–æ–∑–¥–∞–µ–º –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö scooters (postgres), –≤ –Ω–µ–π —Ç–∞–±–ª–∏—Ü—É scooters.

–¢—Ä–µ—Ö—Å–ª–æ–π–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:

- —Å–ª–æ–π –¥–∞–Ω–Ω—ã—Ö (–±–¥, —Å–∞–º–æ–∫–∞—Ç—ã –∏ –≤—Å–µ —Ç–∞–∫–æ–µ)

- –ª–æ–≥–∏–∫–∞

- –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–≤ –±–µ–∫—ç–Ω–¥–µ –≤—Å—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ –≤ json)

–ü–∏—à–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö (—Å–ø–∏—Å–æ–∫ —Å–∞–º–æ–∫–∞—Ç–æ–≤).

–ú–ï–ù–Ø–ï–ú –í –§–ê–ô–õ–ï postgres_dsn —Å—Ç—Ä–æ–∫—É –¥–ª—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (–µ—Å–ª–∏ –ø–µ—Ä–µ–¥ —ç—Ç–∏–º –∑–∞–ø—É—Å–∫–∞–ª PgAdmin4, –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å, –∏–Ω–∞—á–µ –ø–æ—Ä—Ç –±—É–¥–µ—Ç –∑–∞–Ω—è—Ç —ç—Ç–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º, –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–∞–Ω–¥–æ–π lsof -i :8000, lsoft –Ω–∞–¥–æ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å).

`postgres://postgres:hackme@localhost:5432/scooters`

–ó–ê–ü–£–°–ö

`python main.py --secrets-dir secrets`

–í –Ω–æ–≤–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ

`curl http://localhost:8080/v1/scooters`

```bash
{"items": [{"id": "58c5080f-6726-42f3-a997-f143ad984201", "location": [37.46829361638372, 55.05982583193995]}, {"id": "8f484690-f92b-417e-9b68-2bd58f1ed700", "location": [37.05780740487775, 55.683570543711426]}, {"id": "becd1d25-1ab8-4f89-a310-e8177a94093f", "location": [37.94867354172965, 55.313234742670744]}, {"id": "917e9894-0822-4a33-9bfc-5121b937b637", "location": [37.14825826460845, 55.00325180712231]}, {"id": "5f32966e-87c9-4725-bf18-3d8439044c11", "location": [37.14117043538411, 55.131343164062876]}, {"id": "45bec7d8-b60e-4fc0-9752-c0b3f6d204ee", "location": [37.70299881637874, 55.75460344872543]}, {"id": "5898c44f-bfb8-4b6f-a14a-36e5797828b1", "location": [37.0970577108166, 55.644623924666305]}, {"id": "abfbb1f6-c9b5-47a5-9f4f-0da16763310b", "location": [37.238075893682485, 55.157759477336185]}, {"id": "0533e457-40f9-468a-ba70-4f1903b55d6b", "location": [37.26313503696669, 55.3111815759084]}, {"id": "aff866f5-6877-4eea-9c19-b90980dd0d65", "location": [37.446735940409766, 55.702897019510004]}]}
```

–í –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ

`curl http://localhost:8080/v1/scooters | json_pp`

–ü–æ–≤–µ—Ä—è–µ–º –≤—Ç–æ—Ä—É—é —Ä—É—á–∫—É

`curl http://localhost:8080/v1/admin/scooters | json_pp`

% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current

```json
                         Dload  Upload   Total   Spent    Left  Speed

100  1357  100  1357    0     0   870k      0 --:--:-- --:--:-- --:--:-- 1325k
{
"items" : [
  {

  "id" : "58c5080f-6726-42f3-a997-f143ad984201",
 "location" : {
    "lat" : 37.4682936163837,
    "lon" : 55.05982583194
 },
 "user" : "postgres"
                         
},
 {
   
                         
 "id" : "8f484690-f92b-417e-9b68-2bd58f1ed700",
 "location" : {
    "lat" : 37.0578074048777,
    "lon" : 55.6835705437114
 },
 "user" : "postgres"
...
 }
]
}                                            
```

"user" : "postgres" - —ç—Ç–æ –æ—à–∏–±–∫–∞, –Ω–∞–¥–æ –∏—Å–ø—Ä–∞–≤–ª—è—Ç—å

–ü–µ—Ä–µ—Ä—ã–≤. 

#### Q&A.

–ü–∞—Ç–µ—Ä–Ω—ã –≤ –∫–æ–¥–µ, –∫–æ—Ç–æ—Ä—ã–µ –º—ã —Å–µ–π—á–∞—Å —Ä–µ–∞–ª–∏–∑—É–µ–º:

- —Å—Ç—Ä–∞—Ç–µ–≥–∏—è (–≤ –±–æ—Ç–µ);

- –¥–µ–∫—Ç–æ—Ä–∞—Ç–æ—Ä;

- –≤–∏—Å–∏—Ç–æ—Ä;

- –±–∏–ª–¥–µ—Ä (—Å–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏);

- —Å–∏–Ω–≥-—Ç–æ–Ω—ã;

- –∏—Ç–µ—Ä–∞—Ç–æ—Ä.

–¶–µ–ª–µ—è –ª–µ–∫—Ü–∏—è –ø—Ä–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏.

–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –≤ –ø–∏—Ç–æ–Ω–µ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã —Å –ø–æ–º–æ—â—å—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ ABC. –í –∫–æ–º–ø–∏–ª–∏—Ä—É–µ–º—ã—Ö —è–∑—ã–∫–∞—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –Ω—É–∂–Ω—ã –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —Å—Ä–∞–∑—É –ø–æ–Ω—è—Ç—å, —á—Ç–æ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏. 

–ù–∞–ø–∏—Å–∞–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —Ç—Ä–µ—Ö—Å–ª–æ–π–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ. –°–¥–µ–ª–∞–ª–∏ —Ç–∞–∫, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ 
–æ—Ç–¥–∞–µ—Ç json.

–î–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –≤ —Ç–µ–∫—Å—Ç –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ì–µ–æ–∫–æ–¥–µ—Ä –Ø–Ω–¥–µ–∫—Å

–î–µ–±–∞–∂–∏–º –æ—à–∏–±–∫—É —Å Null –≤ –∞–¥—Ä–µ—Å–µ.

mypy - –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, —á—Ç–æ–±—ã —á–∏—Ç–∞—Ç—å —Ç–∞–π–ø–∏–Ω–≥–∏ (–¥–ª—è –¥–µ–±–∞–≥–∞) - —ç—Ç–æ –ª–∏–Ω—Ç–µ—Ä –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç.

–ü–†–û–í–ï–†–Ø–ï–ú –ü–û–°–õ–ï –î–ï–ë–ê–ì–ê.

`curl http://localhost:8080/v1/admin/scooters | json_pp`

```json
% Total % Received % Xferd Average Speed Time Time Time Current
 Dload Upload Total Spent Left Speed
100 5528 100 5528 0 0 1457 0 0:00:03 0:00:03 --:--:-- 1457
{
 "items" : [
 {
 "address" : "–†–æ—Å—Å–∏—è, –ú–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å, –≥–æ—Ä–æ–¥—Å–∫–æ–π –æ–∫—Ä—É–≥ –ß–µ—Ö–æ–≤, —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∞–ª—å–Ω—ã–π –æ—Ç–¥–µ–ª –°—Ç—Ä–µ–º–∏–ª–æ–≤—Å–∫–∏–π",
 "id" : "58c5080f-6726-42f3-a997-f143ad984201",
 "location" : {
 "lat" : 37.4682936163837,
 "lon" : 55.05982583194
 },
 "user" : "postgres"
 },
 {
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–µ–¥–ª–µ–Ω–Ω–æ Elapsed time: 3.0557057857513428
–ò —ç—Ç–æ –¥–ª—è 10 —Å–∞–º–æ–∫–∞—Ç–æ–≤, –æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ
–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –±—ç–∫–µ–Ω–¥–∞ - –±—É–¥–µ–º —Ö–æ–¥–∏—Ç –≤ –≥–µ–æ–∫–æ–¥–µ—Ä –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ.

–£–ª—É—á—à–µ–Ω–∏–µ –∑–∞ —Å—á–µ—Ç –∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏ –¥–æ Elapsed time: 0.8750975131988525

–ü–µ—Ä–µ—Ä—ã–≤. 

#### Q&A.

–î–∞—Ç–∞–∫–ª–∞—Å—Å—ã - —Å–ø–æ—Å–æ–± —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ dto.
